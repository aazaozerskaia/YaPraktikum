**!** Если проект **не открывается**, можно перейти по ссылке:
https://nbviewer.jupyter.org/github/aazaozerskaia/YaPraktikum/blob/main/gold%20recovery/%D0%9A%D0%BE%D1%8D%D1%84%D1%84%D0%B8%D1%86%D0%B8%D0%B5%D0%BD%D1%82%20%D0%B2%D0%BE%D1%81%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%B7%D0%BE%D0%BB%D0%BE%D1%82%D0%B0.ipynb


**Задача** - подготовка прототипа модели ML для предсказания коэф-та восстановления золота

**Ключевые шаги**  
1. Обработка и подготовка данных;
2. Исследовательский анализ данных;
3. Создание функции sMAPE;
4. Определение параметров модели;
5. Построение моделей, предсказывающих вектор из двух значений

**Описание**  
Нам предоставлены данные с параметрами разных этапов добычи и очистки металлов из руды. Для эффективной работы промышленного предприятия необходимо оптимизировать производство, то есть "настроить" правильно процессы восстановления золота из золотосодержащей руды.  
Всего 4 стадии очистки добытой руды: первичная обработка, флотация, двухэтапная очистка. После каждой стадии появляются отвальные хвосты. На каждом этапе чистки происходит регуляция параметров: воздуха, воды, также меняется размер гранул и скорость подачи.  
Для расчёта эффективности предлагается использовать метрику Recovery, а для решения задачи - sMAPE (MAE в относительных величинах).  
Так как на финальный результат влияют промежуточные метрики, требуется предсказать 2 признака - эфф-ть обогащения чернового и финального концентратов и на их основе посчитать финальное sMAPE (предсказать двойной таргет).

**Вывод**  
В датафрейме содержатся наблюдения по очистке руды за каждый час на протяжении почти 1,5 года. Можем отметить, что на протяжении всего процесса очистки концентрация золота растёт заметнее остальных и в среднем составила 43% от смеси на финальной стадии.  
В задании требовалось предсказать векторы по двум значениям, поэтому были выбраны модели дерева решений и случайного леса. На основе данных о добыче и очистке металлов, были построены модели, которые предсказывают коэффициент восстановления золота из руды. С помощью метрики sMAPE была выбрана модель случайного леса. Тестирование модели показало sMAPE = 6,7%.
На эффективность восстановления оказывают влияние такие факторы, как доля руды в начальной смеси, разные составы реагентов, параметры флотационной установки (вода, воздух), размер гранул сырья и другие.

**Библиотеки**  
Pandas, numpy, sklearn, matplotlib
